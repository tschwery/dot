#!/bin/sh

cd `dirname $0`

CLEANMODE=0

while [ $# -gt 0 ]
do
    case "$1" in
    --clean|-c) CLEANMODE=1;;
    *)          echo "usage: $0 [--clean][-c]" >&2
                exit 1;;
    esac
shift
done

for file in *; do
    case "$file" in
    awesome|feh)
        dest_file="config/$file"
        ;;
    *)
        dest_file="$file"
        ;;
    esac

    if [ $file = `basename $0` -o $file = "README" ]; then
	continue
    fi

    if [ -e "$HOME/.$dest_file" -o -h "$HOME/.$dest_file" ]; then
        if [ $CLEANMODE = 0 ]; then
            printf "\033[1;33m[ALREADY]\033[m %s\n" $file
            continue
        else
            printf "\033[1;33m[DELETING]\033[m" $file
            rm "$HOME/.$dest_file"
        fi
    fi

    ln -vs "`pwd`/$file" "$HOME/.$dest_file" > /dev/null 2> /dev/null

    if [ $? -eq 0 ]; then
        printf "\033[1;32m[SUCCESS]\033[m %s\n" $file
    else
        printf "\033[1;31m[FAILURE]\033[m %s\n" $file
    fi
done
